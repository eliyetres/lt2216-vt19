<?xml version="1.0" encoding="UTF-8"?>
<vxml version="2.1" xmlns="http://www.w3.org/2001/vxml" xmlns:voxeo="http://community.voxeo.com/xmlns/vxml">
    <nomatch>I didn't understand.<reprompt />
    </nomatch>
    <noinput>You didn't say anything.<reprompt />
    </noinput> <!-- Data model -->
    <var name="from" />
    <var name="to" />
    <var name="returnDate" />
    <var name="returnTo" />
    <var name="oneway" />
    <var name="confirm" />
    <!-- Menu -->
    <menu id="mainmenu">
        <prompt>
            <break time="2000" />Welcome to the flight booking service. Do you want to <enumerate />
        </prompt>
        <choice next="#askFrom"> book </choice>
        <choice next="#askDelayed"> check delayed </choice>
    </menu>
    <!-- Delayed flights -->
    <form id="askDelayed">
        <block>
                All flights are on time.
                <goto next="#mainmenu" />
        </block>
    </form>
    <!-- Leaving from -->
    <form id="askFrom">
        <field name="fromField">
            <prompt bargein="false">
                <break time="8000" />What city are you leaving from?
            </prompt>
            <noinput>The options are: London, Paris or New York.<reprompt />
            </noinput>
            <option>london</option>
            <option>paris</option>
            <option>new york</option>
        </field>
        <filled>
            <assign name="from" expr="fromField" />
            <goto next="#askTo" />
        </filled>
    </form>
    <!-- Going to  -->
    <form id="askTo">
        <field name="toField">
            <prompt bargein="false"><break time="8000" />Where are you travelling to?
            </prompt>
            <noinput>The options are: London, Paris or New York.<reprompt />
            </noinput>
            <option>london</option>
            <option>paris</option>
            <option>new york</option>
        </field>
        <filled>
            <assign name="to" expr="toField" />
            <!-- Error if from and to dates are the same, start over  -->
            <if cond="from == to ">
                <prompt bargein="false">I'm sorry, you can't leave and return to the same city.</prompt>
                <clear namelist="to"/>
                <goto next="#askTo" />
            </if>
            <goto next="#askDate" />
        </filled>
    </form>
    <!-- Select one-way trip or return -->
    <form id="askDate">
        <field name="toField">
            <prompt bargein="false">Is it a one-way trip?</prompt>
            <option>yes</option>
            <option>no</option>
        </field>
        <filled>
            <assign name="oneway" expr="toField" />
            <if cond="oneway == 'yes'">
                <goto next="#askOneWay" />
                <else />
                <goto next="#askReturn" />
            </if>
        </filled>
    </form> <!-- If YES for one way trip ask to confirm-->
    <form id="askOneWay">
        <field name="oneWayField">
            <prompt bargein="false">Do you want to travel from <value expr="from" />?</prompt>
            <option>yes</option>
            <option>no</option>
        </field>
        <filled>
            <assign name="confirm" expr="oneWayField" />
            <if cond="confirm == 'yes'">
                <goto next="#askConfirmOne" />
                <else />
                <goto next="#askFrom" />
            </if>
        </filled>
    </form>
    <!-- If NO for one way trip ask return day -->
    <form id="askReturn">
        <field name="returnOn">
            <prompt bargein="false">What date do you want to return?</prompt>
            <option>Tomorrow</option>
            <option>Monday</option>
            <option>Tuesday</option>
            <option>Wednesday</option>
            <option>Thursday</option>
            <option>Friday</option>
            <option>Saturday</option>
            <option>Sunday</option>
            <nomatch>
        I didn't hear that. You can select tomorrow, or any weekday.
        <reprompt />
            </nomatch>
        </field>
        <filled>
            <assign name="date" expr="returnOn" />
            <goto next="#askConfirmTwo" />
        </filled>
    </form>
    <!-- Booking complete, confirmations -->
    <form id="askConfirmOne">
        <block>Your one-way flight has been confirmed! You're travelling from <value expr="from" />.
            <goto next="#mainmenu" />
        </block>
    </form>
    <form id="askConfirmTwo">
        <block>Your return flight has been confirmed! You're travelling from <value expr="from" />to<value expr="to" />on<value expr="date" />.            
            <goto next="#mainmenu" />
        </block>
    </form>
</vxml>